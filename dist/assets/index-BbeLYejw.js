import{u as N,a as S,f as D}from"./game-Dw5vbGhC.js";import{f as C,a as j}from"./format-GyRy-UB-.js";import{d as A,c as _,a as n,b as t,t as s,u as r,i as m,F as v,e as u,o as i,h as c,n as b,_ as R}from"./index-DHn3yG1W.js";const E={class:"history-page min-h-full p-4 pb-20"},M={key:0,class:"text-center text-gray-500 mt-10"},W={key:1,class:"text-center text-gray-500 mt-10"},B={key:2,class:"space-y-4"},G={class:"mahjong-card"},V={class:"flex items-center justify-between mb-3"},$={class:"text-sm text-gray-500"},F={class:"grid grid-cols-2 gap-2 text-sm"},I={class:"text-gray-600"},L={class:"font-bold text-gray-800"},z={class:"text-gray-600"},H={class:"font-bold text-gray-800"},Y={class:"text-gray-600"},q={class:"font-bold text-gray-800"},J={class:"flex items-start justify-between mb-3"},K={class:"flex items-center gap-2"},O={class:"round-number"},Q={class:"text-xs text-gray-500"},U=["onClick"],X={class:"mb-3"},Z={key:0,class:"flex items-center justify-between text-xs text-gray-600 mb-1"},ee={key:0,class:"text-orange-600 font-bold"},te={key:0},se={key:1,class:"text-blue-600"},ae={class:"flex items-center gap-2 mb-2 flex-wrap"},ne={key:0,class:"win-type-badge draw"},ie={key:0,class:"winner-badge"},oe={key:0,class:"text-xs"},le={class:"tai-badge"},re={key:1,class:"hand-type-badge"},ce={class:"mt-2 text-xs text-gray-500"},de={class:"score-changes"},pe={class:"player-info"},_e=A({__name:"index",setup(me){const d=N(),w=_(()=>d.isGameActive),h=_(()=>d.gameState),y=_(()=>d.currentRounds),f=_(()=>d.currentSettings),g=S,k=D,T=_(()=>[...y.value].reverse());function l(x){var p;const a=(p=h.value)==null?void 0:p.players.find(e=>e.position===x);return a?a.name:""}function P(x){confirm("確定要刪除這筆記錄嗎？刪除後該局之後的記錄也會被移除。")&&d.deleteRound(x)}return(x,a)=>{var p;return i(),n("div",E,[a[7]||(a[7]=t("h1",{class:"text-2xl font-bold text-center mb-4 text-mahjong-green"}," 歷史記錄 ",-1)),w.value?y.value.length===0?(i(),n("div",W,[...a[1]||(a[1]=[t("p",{class:"text-4xl mb-3"},"🎮",-1),t("p",null,"尚未有任何記錄",-1),t("p",{class:"text-sm mt-2"},"開始記錄第一局吧！",-1)])])):(i(),n("div",B,[t("div",G,[t("div",V,[a[2]||(a[2]=t("h2",{class:"font-bold text-gray-800"},"遊戲資訊",-1)),t("span",$,s(r(C)(((p=h.value)==null?void 0:p.startTime)||0)),1)]),t("div",F,[t("div",I,[a[3]||(a[3]=m(" 總局數：",-1)),t("span",L,s(y.value.length),1)]),t("div",z,[a[4]||(a[4]=m(" 底分：",-1)),t("span",H,s(f.value.basePoint)+" 元",1)]),t("div",Y,[a[5]||(a[5]=m(" 底：",-1)),t("span",q,s(f.value.baseMultiplier)+" 底",1)])])]),(i(!0),n(v,null,u(T.value,e=>(i(),n("div",{key:e.id,class:"round-card mahjong-card"},[t("div",J,[t("div",K,[t("span",O,"第 "+s(e.roundNumber)+" 局",1),t("span",Q,s(r(j)(e.timestamp)),1)]),t("button",{onClick:o=>P(e.id),class:"text-red-500 text-xs px-2 py-1 hover:bg-red-50 rounded transition-colors"}," 刪除 ",8,U)]),t("div",X,[e.dealerPosition?(i(),n("div",Z,[t("span",null,"莊家："+s(r(g)[e.dealerPosition])+" "+s(l(e.dealerPosition)),1),e.isDealerWin?(i(),n("span",ee,[a[6]||(a[6]=m(" → 連莊",-1)),e.dealerWinCount?(i(),n("span",te,"("+s(e.dealerWinCount)+"連)",1)):c("",!0)])):e.nextDealer?(i(),n("span",se," → "+s(r(g)[e.nextDealer])+" "+s(l(e.nextDealer)),1)):c("",!0)])):c("",!0),t("div",ae,[e.winType==="draw"?(i(),n("span",ne," 流局 ")):(i(),n(v,{key:1},[e.winType==="self_draw"?(i(),n("span",ie,[m(s(l(e.winnerPosition))+" ",1),e.dealerPosition===e.winnerPosition?(i(),n("span",oe,"（莊）")):c("",!0)])):c("",!0),t("span",{class:b(["win-type-badge",e.winType])},s(e.winType==="self_draw"?"自摸":`${l(e.winnerPosition)} 胡 ${l(e.loserPosition)}`),3),t("span",le,s(e.tai)+" 台",1),e.handTypes&&e.handTypes.length>0?(i(),n("span",re,s(e.handTypes.map(o=>r(k)[o]).join("+")),1)):c("",!0)],64))])]),t("div",ce," 計算：("+s(e.baseMultiplier)+"底 + "+s(e.tai)+"台) × "+s(e.basePoint)+"元/台 ",1),t("div",de,[(i(!0),n(v,null,u(e.scoreChanges,o=>(i(),n("div",{key:o.position,class:"score-change-item"},[t("span",pe,s(r(g)[o.position])+" "+s(l(o.position)),1),t("span",{class:b(["score-value",{positive:o.change>0,negative:o.change<0}])},s(o.change>0?"+":"")+s(o.change.toLocaleString()),3)]))),128))])]))),128))])):(i(),n("div",M,[...a[0]||(a[0]=[t("p",{class:"text-4xl mb-3"},"📋",-1),t("p",null,"目前沒有進行中的遊戲",-1),t("p",{class:"text-sm mt-2"},"請先開始新遊戲",-1)])]))])}}}),ve=R(_e,[["__scopeId","data-v-03e82531"]]);export{ve as default};
