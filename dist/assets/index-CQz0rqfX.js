import{D as ge,W as me,a as B,b as pe,H as xe,c as h,d as _e,C as ye,e as he,f as T,u as ke}from"./game-ci-dnODn.js";import{d as Y,r as L,c as b,a as n,b as e,F as C,e as P,u as d,w as I,v as ee,f as te,g as J,o as s,t as o,_ as Q,h as m,n as S,i as V,j as we,k as Te,l as Se,m as K}from"./index-C0SgLKMm.js";import{C as $e}from"./ConfirmDialog-MvmqYuLl.js";const Ce={class:"player-setup mahjong-card"},De={class:"space-y-3 mb-6"},Re={class:"flex-shrink-0 w-12 h-12 bg-mahjong-green text-white rounded-lg flex items-center justify-center font-bold text-lg"},Pe=["onUpdate:modelValue","placeholder"],je={class:"space-y-3 mb-6"},Ne={class:"flex items-center justify-between"},Ae={class:"flex items-center justify-between"},We={class:"flex items-center justify-between"},Ee={class:"border-t border-gray-200 pt-3 space-y-3"},Le={class:"flex items-center justify-between"},Fe={class:"relative inline-flex items-center cursor-pointer"},Me={class:"flex items-center justify-between"},Ie={class:"relative inline-flex items-center cursor-pointer"},He={class:"flex items-center justify-between"},Ge={class:"relative inline-flex items-center cursor-pointer"},Oe=["disabled"],Ue=Y({__name:"PlayerSetup",props:{defaultPlayerNames:{default:()=>["","","",""]},defaultSettings:{}},emits:["start"],setup(c,{emit:y}){const g=c,D=y,R=B,i=me,k=L(g.defaultPlayerNames||["","","",""]),p=L({...ge,...g.defaultSettings}),j=b(()=>k.value.some(N=>N.trim()!==""));function G(){if(!j.value)return;const N=k.value.map((l,r)=>l.trim()||`玩家${r+1}`);D("start",N,p.value)}return(N,l)=>(s(),n("div",Ce,[l[18]||(l[18]=e("h2",{class:"text-xl font-bold text-center mb-4 text-mahjong-green"}," 設定玩家 ",-1)),e("div",De,[(s(!0),n(C,null,P(d(i),(r,v)=>(s(),n("div",{key:r,class:"flex items-center gap-3"},[e("div",Re,o(d(R)[r]),1),I(e("input",{"onUpdate:modelValue":$=>k.value[v]=$,type:"text",placeholder:`玩家 ${v+1}`,class:"mahjong-input flex-1",maxlength:"10"},null,8,Pe),[[te,k.value[v]]])]))),128))]),e("div",je,[l[17]||(l[17]=e("h3",{class:"font-bold text-gray-700"},"遊戲設定",-1)),e("div",Ne,[l[7]||(l[7]=e("label",{class:"text-gray-700"},"底分（元）",-1)),I(e("select",{"onUpdate:modelValue":l[0]||(l[0]=r=>p.value.basePoint=r),class:"select-field"},[...l[6]||(l[6]=[e("option",{value:1},"1 元",-1),e("option",{value:5},"5 元",-1),e("option",{value:10},"10 元",-1),e("option",{value:20},"20 元",-1),e("option",{value:50},"50 元",-1),e("option",{value:100},"100 元",-1)])],512),[[ee,p.value.basePoint,void 0,{number:!0}]])]),e("div",Ae,[l[9]||(l[9]=e("label",{class:"text-gray-700"},"底（台）",-1)),I(e("select",{"onUpdate:modelValue":l[1]||(l[1]=r=>p.value.baseMultiplier=r),class:"select-field"},[...l[8]||(l[8]=[e("option",{value:0},"0 底",-1),e("option",{value:1},"1 底",-1),e("option",{value:2},"2 底",-1),e("option",{value:3},"3 底",-1),e("option",{value:4},"4 底",-1)])],512),[[ee,p.value.baseMultiplier,void 0,{number:!0}]])]),e("div",We,[l[10]||(l[10]=e("label",{class:"text-gray-700"},"起始分數",-1)),I(e("input",{"onUpdate:modelValue":l[2]||(l[2]=r=>p.value.startingScore=r),type:"number",class:"w-32 px-4 py-2 border border-gray-300 rounded-lg text-right"},null,512),[[te,p.value.startingScore,void 0,{number:!0}]])]),e("div",Ee,[e("div",Le,[l[12]||(l[12]=e("div",null,[e("label",{class:"text-gray-700 font-medium"},"見花"),e("p",{class:"text-xs text-gray-500"},"每張花牌加 1 台")],-1)),e("label",Fe,[I(e("input",{"onUpdate:modelValue":l[3]||(l[3]=r=>p.value.enableFlowerTiles=r),type:"checkbox",class:"sr-only peer"},null,512),[[J,p.value.enableFlowerTiles]]),l[11]||(l[11]=e("div",{class:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-mahjong-green rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-mahjong-green"},null,-1))])]),e("div",Me,[l[14]||(l[14]=e("div",null,[e("label",{class:"text-gray-700 font-medium"},"見字"),e("p",{class:"text-xs text-gray-500"},"風牌、三元牌加台")],-1)),e("label",Ie,[I(e("input",{"onUpdate:modelValue":l[4]||(l[4]=r=>p.value.enableHonorTiles=r),type:"checkbox",class:"sr-only peer"},null,512),[[J,p.value.enableHonorTiles]]),l[13]||(l[13]=e("div",{class:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-mahjong-green rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-mahjong-green"},null,-1))])]),e("div",He,[l[16]||(l[16]=e("div",null,[e("label",{class:"text-gray-700 font-medium"},"嚦咕嚦咕")],-1)),e("label",Ge,[I(e("input",{"onUpdate:modelValue":l[5]||(l[5]=r=>p.value.enableLiuLiu=r),type:"checkbox",class:"sr-only peer"},null,512),[[J,p.value.enableLiuLiu]]),l[15]||(l[15]=e("div",{class:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-mahjong-green rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-mahjong-green"},null,-1))])])])]),e("button",{onClick:G,disabled:!j.value,class:"w-full mahjong-button disabled:opacity-50 disabled:cursor-not-allowed"}," 開始遊戲 ",8,Oe)]))}}),Ve=Q(Ue,[["__scopeId","data-v-bdebb731"]]),Be={class:"score-board"},Ye={class:"grid grid-cols-2 gap-3 mb-4"},ze={class:"flex items-center justify-between mb-2"},qe={class:"flex items-center gap-2"},Je={class:"w-8 h-8 bg-mahjong-green text-white rounded flex items-center justify-center text-sm font-bold"},Ke={class:"font-bold text-gray-800 truncate"},Qe={key:0,class:"text-xs bg-red-500 text-white px-2 py-0.5 rounded font-bold"},Xe={key:0},Ze={class:"text-right"},et={class:"stats-info text-center text-sm text-gray-600"},tt={key:0},st={key:1,class:"mt-2"},nt={class:"inline-flex items-center gap-1 bg-orange-100 text-orange-700 px-3 py-1 rounded-full font-bold text-xs"},lt={key:0,class:"text-red-600"},ot={key:1},at=Y({__name:"ScoreBoard",props:{players:{},currentRound:{},totalRounds:{default:0},highlightedPosition:{},currentDealer:{},dealerWinCount:{}},setup(c){const y=B;function g(D){return D>0?`+${D.toLocaleString()}`:D.toLocaleString()}return(D,R)=>(s(),n("div",Be,[R[1]||(R[1]=e("h2",{class:"text-xl font-bold text-center mb-4 text-mahjong-green"}," 計分板 ",-1)),e("div",Ye,[(s(!0),n(C,null,P(c.players,i=>(s(),n("div",{key:i.id,class:S(["score-card mahjong-card",{highlight:c.highlightedPosition===i.position,"dealer-card":c.currentDealer===i.position}])},[e("div",ze,[e("div",qe,[e("div",Je,o(d(y)[i.position]),1),e("span",Ke,o(i.name),1),c.currentDealer===i.position?(s(),n("span",Qe,[R[0]||(R[0]=V(" 莊",-1)),c.dealerWinCount&&c.dealerWinCount>0?(s(),n("span",Xe,o(c.dealerWinCount),1)):m("",!0)])):m("",!0)])]),e("div",Ze,[e("div",{class:S(["text-2xl font-bold",{"text-green-600":i.totalScore>0,"text-red-600":i.totalScore<0,"text-gray-600":i.totalScore===0}])},o(g(i.totalScore)),3)])],2))),128))]),e("div",et,[e("p",null,"第 "+o(c.currentRound)+" 局",1),c.totalRounds>0?(s(),n("p",tt,"總共 "+o(c.totalRounds)+" 局",1)):m("",!0),c.currentDealer&&c.dealerWinCount!==void 0?(s(),n("p",st,[e("span",nt,[e("span",null,"莊家："+o(d(y)[c.currentDealer]),1),c.dealerWinCount>0?(s(),n("span",lt,o(c.dealerWinCount)+"連勝",1)):(s(),n("span",ot,"新莊"))])])):m("",!0)])]))}}),it=Q(at,[["__scopeId","data-v-747a9542"]]),rt={class:"score-input mahjong-card"},ut={class:"mb-6"},dt={class:"grid grid-cols-4 gap-2"},ct=["onClick"],vt={class:"text-lg font-bold"},ft={key:0,class:"text-red-600"},bt={class:"text-xs truncate"},gt={key:0,class:"mb-6"},mt={class:"grid grid-cols-2 gap-3"},pt={key:0,class:"mt-4 bg-orange-50 p-3 rounded-lg"},xt={class:"flex items-center justify-between"},_t={class:"text-gray-700 font-medium"},yt={class:"text-orange-600 font-bold"},ht={class:"mt-1 text-xs text-gray-600 text-center"},kt={key:1,class:"mb-6"},wt={class:"grid grid-cols-3 gap-2"},Tt=["onClick"],St={class:"text-lg font-bold"},$t={key:0,class:"text-red-600"},Ct={class:"text-xs truncate"},Dt={key:2,class:"mb-6"},Rt={class:"font-bold text-gray-700 mb-3"},Pt={key:0,class:"mb-3"},jt={class:"grid grid-cols-3 gap-2"},Nt=["onClick"],At={class:"mb-3"},Wt={class:"grid grid-cols-3 gap-2"},Et=["onClick"],Lt={class:"mb-3"},Ft={class:"grid grid-cols-3 gap-2"},Mt=["onClick"],It={class:"mb-3"},Ht={class:"grid grid-cols-3 gap-2"},Gt=["onClick"],Ot={class:"mb-3"},Ut={class:"grid grid-cols-3 gap-2"},Vt=["onClick"],Bt={class:"mb-3"},Yt={class:"grid grid-cols-3 gap-2"},zt=["onClick"],qt={class:"mb-3"},Jt={class:"grid grid-cols-3 gap-2"},Kt=["onClick"],Qt={class:"flex justify-center"},Xt={key:3,class:"mb-6"},Zt={class:"font-bold text-gray-700 mb-3"},es={class:"bg-gradient-to-r from-green-50 to-blue-50 p-4 rounded-lg"},ts={class:"space-y-2 text-sm"},ss={key:0,class:"flex justify-between items-center"},ns={key:1,class:"flex justify-between items-center"},ls={class:"text-gray-700"},os={class:"font-bold text-purple-600"},as={key:2,class:"flex justify-between items-center"},is={class:"text-gray-700"},rs={class:"font-bold text-orange-600"},us={class:"pt-2 border-t-2 border-gray-300 space-y-1"},ds={class:"flex justify-between items-center"},cs={class:"font-bold text-mahjong-green text-xl"},vs={class:"flex justify-between items-center"},fs={class:"text-gray-700 text-xs"},bs={key:0},gs={class:"font-bold text-blue-600 text-lg"},ms={key:0,class:"text-xs text-gray-500 text-center pt-1"},ps={key:1,class:"text-xs text-gray-500 text-center pt-1"},xs={key:4,class:"mb-6 p-4 bg-gray-50 rounded-lg"},_s={class:"space-y-1"},ys={class:"text-sm"},hs={class:"mt-2 text-xs text-gray-500 text-center"},ks={class:"space-y-3"},ws={class:"flex gap-3"},Ts=["disabled"],Ss=Y({__name:"ScoreInput",props:{players:{},basePoint:{},baseMultiplier:{},enableFlowerTiles:{type:Boolean,default:!1},enableHonorTiles:{type:Boolean,default:!1},currentDealer:{},dealerWinCount:{default:0}},emits:["submit"],setup(c,{emit:y}){const g=c,D=y,R=B,i=he,k=ye,p=b(()=>g.enableFlowerTiles),j=b(()=>g.enableHonorTiles),G=b(()=>g.currentDealer||pe.EAST),N=b(()=>g.dealerWinCount||0),l=L(),r=L(),v=L(),$=L(),_=L();we(G,u=>{l.value=u},{immediate:!0});const z=b(()=>g.players.filter(u=>u.position!==r.value)),f=b(()=>r.value===l.value),x=b(()=>$.value===l.value),A=b(()=>_.value&&xe[_.value]||0),E=b(()=>N.value*2+1),W=b(()=>{let u=0;return v.value===h.SELF_DRAW&&(u=1),u+=A.value,(f.value||x.value)&&(u+=E.value),v.value===h.SELF_DRAW&&(u=Math.max(1,u)),u}),H=b(()=>(g.baseMultiplier+W.value)*g.basePoint),O=b(()=>v.value===h.SELF_DRAW?H.value*3:H.value),w=b(()=>H.value),U=b(()=>!(!r.value||!v.value||v.value===h.DISCARD&&!$.value)),X=b(()=>U.value&&W.value>0),se=b(()=>U.value?_e(r.value,v.value,$.value,W.value,g.basePoint,g.baseMultiplier):[]);function ne(u){r.value=u,$.value===u&&($.value=void 0)}function Z(u){v.value=u,u===h.SELF_DRAW&&($.value=void 0)}function le(u){$.value=u}function M(u){_.value=u}function oe(){_.value=void 0}function ae(u){const a=g.players.find(t=>t.position===u);return a?a.name:""}function q(){r.value=void 0,v.value=void 0,$.value=void 0,_.value=void 0}function ie(){X.value&&(D("submit",{dealerPosition:l.value,winnerPosition:r.value,winType:v.value,tai:W.value,loserPosition:$.value,handType:_.value}),q())}function re(){l.value&&(D("submit",{dealerPosition:l.value,winnerPosition:l.value,winType:h.DRAW,tai:0,loserPosition:void 0,handType:void 0}),q())}function ue(){return k.tai1.filter(a=>[T.RED_DRAGON,T.GREEN_DRAGON,T.WHITE_DRAGON,T.EAST_WIND,T.SOUTH_WIND,T.WEST_WIND,T.NORTH_WIND].includes(a)?j.value:a===T.CORRECT_FLOWER?p.value:!0)}function de(){return k.tai2.filter(a=>!(v.value===h.SELF_DRAW&&[T.ALL_HUMAN,T.COMMON].includes(a)))}function ce(){return k.tai4.filter(a=>a===T.SMALL_THREE_DRAGONS?j.value:!0)}function ve(){return k.tai8.filter(a=>[T.BIG_THREE_DRAGONS,T.SMALL_FOUR_WINDS].includes(a)?j.value:a===T.ALL_FLOWERS?p.value:!0)}function fe(){return k.tai16.filter(a=>[T.BIG_FOUR_WINDS,T.ALL_HONORS].includes(a)?j.value:!0)}function be(){return k.tai24}return(u,a)=>(s(),n("div",rt,[a[17]||(a[17]=e("h2",{class:"text-xl font-bold text-center mb-4 text-mahjong-green"}," 記錄本局 ",-1)),e("div",ut,[a[2]||(a[2]=e("h3",{class:"font-bold text-gray-700 mb-3"},"1. 誰胡牌？",-1)),e("div",dt,[(s(!0),n(C,null,P(c.players,t=>(s(),n("button",{key:t.id,onClick:F=>ne(t.position),class:S(["player-button",{active:r.value===t.position,"dealer-button":l.value===t.position}])},[e("div",vt,[V(o(d(R)[t.position])+" ",1),t.position===l.value?(s(),n("span",ft,"莊")):m("",!0)]),e("div",bt,o(t.name),1)],10,ct))),128))])]),r.value?(s(),n("div",gt,[a[5]||(a[5]=e("h3",{class:"font-bold text-gray-700 mb-3"},"2. 胡牌方式",-1)),e("div",mt,[e("button",{onClick:a[0]||(a[0]=t=>Z(d(h).SELF_DRAW)),class:S(["win-type-button",{active:v.value===d(h).SELF_DRAW}])},[...a[3]||(a[3]=[e("span",{class:"text-2xl mb-1"},"🎯",-1),e("span",{class:"font-bold"},"自摸",-1)])],2),e("button",{onClick:a[1]||(a[1]=t=>Z(d(h).DISCARD)),class:S(["win-type-button",{active:v.value===d(h).DISCARD}])},[...a[4]||(a[4]=[e("span",{class:"text-2xl mb-1"},"💥",-1),e("span",{class:"font-bold"},"放槍",-1)])],2)]),v.value&&(f.value||x.value)?(s(),n("div",pt,[e("div",xt,[e("span",_t,o(f.value?"莊家台數":"胡莊家台數"),1),e("span",yt," +"+o(E.value)+" 台 ",1)]),e("div",ht,o(f.value?"連莊":"破莊")+o(N.value)+"次：2×"+o(N.value)+" + 1 = "+o(E.value)+"台 ",1)])):m("",!0)])):m("",!0),v.value===d(h).DISCARD?(s(),n("div",kt,[a[6]||(a[6]=e("h3",{class:"font-bold text-gray-700 mb-3"},"3. 誰放槍？",-1)),e("div",wt,[(s(!0),n(C,null,P(z.value,t=>(s(),n("button",{key:t.id,onClick:F=>le(t.position),class:S(["player-button",{active:$.value===t.position,"dealer-button":l.value===t.position}])},[e("div",St,[V(o(d(R)[t.position])+" ",1),t.position===l.value?(s(),n("span",$t,"莊")):m("",!0)]),e("div",Ct,o(t.name),1)],10,Tt))),128))])])):m("",!0),v.value?(s(),n("div",Dt,[e("h3",Rt,o(v.value===d(h).DISCARD?"4":"3")+". 牌型（可選） ",1),d(k).tai0.length>0?(s(),n("div",Pt,[a[7]||(a[7]=e("div",{class:"text-xs text-gray-500 mb-2"},"0台",-1)),e("div",jt,[(s(!0),n(C,null,P(d(k).tai0,t=>(s(),n("button",{key:t,onClick:F=>M(t),class:S(["hand-type-button",{active:_.value===t}])},o(d(i)[t]),11,Nt))),128))])])):m("",!0),e("div",At,[a[8]||(a[8]=e("div",{class:"text-xs text-gray-500 mb-2"},"1台",-1)),e("div",Wt,[(s(!0),n(C,null,P(ue(),t=>(s(),n("button",{key:t,onClick:F=>M(t),class:S(["hand-type-button",{active:_.value===t}])},o(d(i)[t]),11,Et))),128))])]),e("div",Lt,[a[9]||(a[9]=e("div",{class:"text-xs text-gray-500 mb-2"},"2台",-1)),e("div",Ft,[(s(!0),n(C,null,P(de(),t=>(s(),n("button",{key:t,onClick:F=>M(t),class:S(["hand-type-button",{active:_.value===t}])},o(d(i)[t]),11,Mt))),128))])]),e("div",It,[a[10]||(a[10]=e("div",{class:"text-xs text-gray-500 mb-2"},"4台",-1)),e("div",Ht,[(s(!0),n(C,null,P(ce(),t=>(s(),n("button",{key:t,onClick:F=>M(t),class:S(["hand-type-button",{active:_.value===t}])},o(d(i)[t]),11,Gt))),128))])]),e("div",Ot,[a[11]||(a[11]=e("div",{class:"text-xs text-gray-500 mb-2"},"8台",-1)),e("div",Ut,[(s(!0),n(C,null,P(ve(),t=>(s(),n("button",{key:t,onClick:F=>M(t),class:S(["hand-type-button",{active:_.value===t}])},o(d(i)[t]),11,Vt))),128))])]),e("div",Bt,[a[12]||(a[12]=e("div",{class:"text-xs text-gray-500 mb-2"},"16台",-1)),e("div",Yt,[(s(!0),n(C,null,P(fe(),t=>(s(),n("button",{key:t,onClick:F=>M(t),class:S(["hand-type-button",{active:_.value===t}])},o(d(i)[t]),11,zt))),128))])]),e("div",qt,[a[13]||(a[13]=e("div",{class:"text-xs text-gray-500 mb-2"},"24台",-1)),e("div",Jt,[(s(!0),n(C,null,P(be(),t=>(s(),n("button",{key:t,onClick:F=>M(t),class:S(["hand-type-button",{active:_.value===t}])},o(d(i)[t]),11,Kt))),128))])]),e("div",Qt,[e("button",{onClick:oe,class:S(["hand-type-button-clear",{active:!_.value}])}," 不記錄牌型 ",2)])])):m("",!0),v.value?(s(),n("div",Xt,[e("h3",Zt,o(v.value===d(h).DISCARD?"5":"4")+". 台數與點數計算 ",1),e("div",es,[e("div",ts,[v.value===d(h).SELF_DRAW?(s(),n("div",ss,[...a[14]||(a[14]=[e("span",{class:"text-gray-700"},"自摸保底",-1),e("span",{class:"font-bold text-green-600"},"+1 台",-1)])])):m("",!0),_.value&&A.value>0?(s(),n("div",ns,[e("span",ls,o(d(i)[_.value]),1),e("span",os,"+"+o(A.value)+" 台",1)])):m("",!0),(f.value||x.value)&&E.value>0?(s(),n("div",as,[e("span",is,o(f.value?"莊家":"胡莊家")+"（"+o(N.value)+"連勝）",1),e("span",rs,"+"+o(E.value)+" 台",1)])):m("",!0),e("div",us,[e("div",ds,[a[15]||(a[15]=e("span",{class:"text-gray-800 font-bold text-base"},"總台數",-1)),e("span",cs,o(W.value)+" 台",1)]),e("div",vs,[e("span",fs,[V(" ("+o(c.baseMultiplier)+"底 + "+o(W.value)+"台) × "+o(c.basePoint)+"元 ",1),v.value===d(h).SELF_DRAW?(s(),n("span",bs," × 3")):m("",!0)]),e("span",gs,o(O.value.toLocaleString())+" 元 ",1)]),v.value===d(h).SELF_DRAW?(s(),n("div",ms," 三家總計（各付 "+o(w.value.toLocaleString())+" 元） ",1)):(s(),n("div",ps," 被胡者支付 "))])])])])):m("",!0),U.value?(s(),n("div",xs,[a[16]||(a[16]=e("h3",{class:"font-bold text-gray-700 mb-2"},"分數變動預覽",-1)),e("div",_s,[(s(!0),n(C,null,P(se.value,t=>(s(),n("div",{key:t.position,class:"flex justify-between items-center"},[e("span",ys,o(d(R)[t.position])+" "+o(ae(t.position)),1),e("span",{class:S(["font-bold",{"text-green-600":t.change>0,"text-red-600":t.change<0}])},o(t.change>0?"+":"")+o(t.change.toLocaleString()),3)]))),128))]),e("div",hs," ("+o(c.baseMultiplier)+"底 + "+o(W.value)+"台) × "+o(c.basePoint)+"元 = "+o((c.baseMultiplier+W.value)*c.basePoint)+" 元 ",1)])):m("",!0),e("div",ks,[e("button",{onClick:re,class:"w-full bg-gray-500 text-white font-bold py-3 px-6 rounded-lg active:scale-95 transition-transform"}," 🔄 流局（莊家連勝+1） "),e("div",ws,[e("button",{onClick:q,class:"flex-1 mahjong-button-secondary"}," 重置 "),e("button",{onClick:ie,disabled:!X.value,class:"flex-1 mahjong-button disabled:opacity-50 disabled:cursor-not-allowed"}," 確認記錄 ",8,Ts)])])]))}}),$s=Q(Ss,[["__scopeId","data-v-c3a6680f"]]),Cs={class:"game-page min-h-full p-4 pb-20"},Ds={key:0,class:"max-w-lg mx-auto"},Rs={key:1,class:"space-y-4"},Ps={class:"flex items-center justify-between mb-4"},js={class:"flex gap-2"},Ns={key:0,class:"mahjong-card"},As={class:"space-y-2"},Ws={class:"flex items-center gap-2 flex-wrap"},Es={class:"text-gray-500"},Ls={key:0,class:"text-gray-600"},Fs={key:0,class:"font-bold text-mahjong-green"},Ms={class:"text-gray-600"},Is={class:"font-bold text-mahjong-gold"},Hs={class:"font-bold text-blue-600"},Gs=["onClick"],Bs=Y({__name:"index",setup(c){const y=ke(),g=L(!1),D=L(["","","",""]),R=b(()=>y.isGameActive),i=b(()=>y.gameState),k=b(()=>y.currentPlayers),p=b(()=>y.currentRounds),j=b(()=>y.currentSettings),G=B,N=b(()=>[...p.value].reverse().slice(0,5));function l(f){var A;if(!f)return"";const x=(A=i.value)==null?void 0:A.players.find(E=>E.position===f);return x?x.name:""}function r(f,x){const A=(f.baseMultiplier+f.tai)*f.basePoint;return x==="self_draw"?A*3:A}Te(()=>{y.loadGameState(),i.value&&R.value&&(D.value=i.value.players.map(f=>f.name))});function v(f,x){y.startNewGame(f,x),D.value=f}function $(f){y.addRound(f.winnerPosition,f.winType,f.tai,f.loserPosition,f.handType)}function _(f){confirm("確定要刪除這筆記錄嗎？刪除後該局之後的記錄也會被移除。")&&y.deleteRound(f)}function z(){y.endGame(),g.value=!1}return(f,x)=>{var A,E,W,H,O;return s(),n("div",Cs,[R.value?(s(),n("div",Rs,[e("div",Ps,[x[2]||(x[2]=e("h1",{class:"text-2xl font-bold text-mahjong-green"},"麻將計分",-1)),e("div",js,[e("button",{onClick:x[0]||(x[0]=w=>g.value=!0),class:"px-4 py-2 bg-red-500 text-white rounded-lg text-sm font-bold active:scale-95 transition-transform"}," 結束遊戲 ")])]),K(it,{players:k.value,"current-round":((A=i.value)==null?void 0:A.currentRoundNumber)||1,"total-rounds":p.value.length,"current-dealer":(E=i.value)==null?void 0:E.currentDealer,"dealer-win-count":(W=i.value)==null?void 0:W.dealerWinCount},null,8,["players","current-round","total-rounds","current-dealer","dealer-win-count"]),K($s,{players:k.value,"base-point":j.value.basePoint,"base-multiplier":j.value.baseMultiplier,"enable-flower-tiles":j.value.enableFlowerTiles,"enable-honor-tiles":j.value.enableHonorTiles,"current-dealer":(H=i.value)==null?void 0:H.currentDealer,"dealer-win-count":(O=i.value)==null?void 0:O.dealerWinCount,onSubmit:$},null,8,["players","base-point","base-multiplier","enable-flower-tiles","enable-honor-tiles","current-dealer","dealer-win-count"]),N.value.length>0?(s(),n("div",Ns,[x[3]||(x[3]=e("h3",{class:"font-bold text-gray-700 mb-3"},"最近記錄",-1)),e("div",As,[(s(!0),n(C,null,P(N.value,w=>(s(),n("div",{key:w.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg text-sm"},[e("div",Ws,[e("span",Es,"第"+o(w.roundNumber)+"局",1),w.winType==="draw"?(s(),n("span",Ls," 流局 ")):(s(),n(C,{key:1},[w.winType==="self_draw"?(s(),n("span",Fs,o(d(G)[w.winnerPosition]),1)):m("",!0),e("span",Ms,o(w.winType==="self_draw"?"自摸":`${l(w.winnerPosition)} 胡 ${l(w.loserPosition)}`),1),e("span",Is,o(w.tai)+"台",1),e("span",Hs,o(r(w,w.winType))+"元 ",1)],64))]),e("button",{onClick:U=>_(w.id),class:"text-red-500 text-xs px-2 py-1 hover:bg-red-50 rounded"}," 刪除 ",8,Gs)]))),128))])])):m("",!0)])):(s(),n("div",Ds,[K(Ve,{"default-player-names":D.value,onStart:v},null,8,["default-player-names"])])),g.value?(s(),Se($e,{key:2,title:"確認結束遊戲？",message:"結束後將無法繼續記錄，但歷史記錄會保留。","confirm-text":"確認結束","cancel-text":"取消",onConfirm:z,onCancel:x[1]||(x[1]=w=>g.value=!1)})):m("",!0)])}}});export{Bs as default};
